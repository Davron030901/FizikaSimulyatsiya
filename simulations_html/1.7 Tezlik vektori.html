```html
<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tezlik Vektori - Interaktiv Simulyatsiya</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            }
        };
    </script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
        }
        
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .header p { font-size: 1.2em; opacity: 0.9; }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .simulation-area, .control-panel {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .control-panel { height: fit-content; }
        
        .canvas-container {
            position: relative;
            width: 100%;
            height: 500px;
            border: 2px solid #ddd;
            border-radius: 10px;
            overflow: hidden;
            background: #f8f9fa;
            margin-bottom: 15px;
        }
        
        .status-bar {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 5px 10px;
            display: flex;
            justify-content: space-between;
            font-size: 0.8em;
            font-family: 'Courier New', monospace;
        }
        
        canvas { width: 100%; height: 100%; display: block; }
        
        .controls-section { margin-bottom: 25px; }
        
        .controls-section h3 {
            color: #4a5568;
            margin-bottom: 15px;
            font-size: 1.1em;
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 5px;
        }
        
        .control-group { margin-bottom: 20px; }
        
        .control-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #2d3748;
        }
        
        .control-group input[type="checkbox"] {
            margin-right: 8px;
            transform: scale(1.2);
        }
        
        .control-group label:has(input[type="checkbox"]) {
            display: flex;
            align-items: center;
            font-weight: 500;
        }
        
        input[type="range"] {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: #e2e8f0;
            outline: none;
            -webkit-appearance: none;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }
        
        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }
        
        .value-display {
            background: #f7fafc;
            padding: 5px 10px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            text-align: center;
            margin-top: 5px;
            border: 1px solid #e2e8f0;
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .btn {
            padding: 10px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 600;
            transition: all 0.3s ease;
            flex: 1;
        }
        
        .btn-primary { background: #667eea; color: white; }
        .btn-primary:hover { background: #5a6fd8; transform: translateY(-2px); }
        .btn-secondary { background: #e2e8f0; color: #4a5568; }
        .btn-secondary:hover { background: #cbd5e0; transform: translateY(-2px); }
        .btn-danger { background: #e53e3e; color: white; }
        .btn-danger:hover { background: #c53030; transform: translateY(-2px); }
        
        .data-display {
            background: #f7fafc;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            border: 1px solid #e2e8f0;
        }
        
        .data-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.9em;
        }
        
        .data-label { font-weight: 600; color: #2d3748; }
        .data-value { font-family: 'Courier New', monospace; color: #4a5568; }
        
        .vector-info {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px;
            border-radius: 8px;
        }
        
        .vector-info h4 { margin-bottom: 10px; font-size: 1.1em; }
        
        .preset-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
        }
        
        .preset-btn {
            padding: 8px 12px;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85em;
            text-align: center;
            transition: all 0.3s ease;
            background: white;
            color: #4a5568;
        }
        
        .preset-btn:hover {
            background: #f7fafc;
            border-color: #667eea;
            transform: translateY(-1px);
        }
        
        .theory-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .theory-section h2 {
            color: #2d3748;
            margin-bottom: 20px;
            font-size: 1.5em;
        }
        
        .formula-box {
            background: #f7fafc;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #667eea;
        }
        
        .help-tooltip {
            position: relative;
            display: inline-block;
            cursor: help;
            color: #667eea;
            font-weight: bold;
        }
        
        .speed-control {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .speed-display {
            background: #667eea;
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.9em;
            min-width: 50px;
            text-align: center;
        }
        
        @media (max-width: 768px) {
            .main-content { grid-template-columns: 1fr; }
            .control-panel { order: -1; }
            .header h1 { font-size: 2em; }
            .button-group { flex-direction: column; }
        }
        
        @media (max-width: 480px) {
            .container { padding: 10px; }
            .header h1 { font-size: 1.5em; }
            .preset-buttons { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéØ Tezlik Vektori</h1>
            <p>2D harakat va tezlik vektorining interaktiv simulyatsiyasi</p>
        </div>

        <div class="main-content">
            <div class="simulation-area">
                <div class="canvas-container">
                    <canvas id="canvas"></canvas>
                    <div class="status-bar">
                        <span id="scaleInfo">Masshtab: 1:1</span>
                        <span id="mousePos">Kursor: (0, 0)</span>
                    </div>
                </div>
                <div class="button-group">
                    <button class="btn btn-primary" id="playBtn">‚ñ∂Ô∏è Boshlash</button>
                    <button class="btn btn-secondary" id="resetBtn">üîÑ Qayta</button>
                    <button class="btn btn-danger" id="clearBtn">üßπ Tozalash</button>
                </div>
                <div class="button-group">
                    <button class="btn btn-secondary" id="zoomIn">üîç+ Kattalashtirish</button>
                    <button class="btn btn-secondary" id="zoomOut">üîç- Kichiklashtirish</button>
                    <button class="btn btn-secondary" id="fitView">üìê To'liq ko'rish</button>
                </div>
            </div>

            <div class="control-panel">
                <div class="controls-section">
                    <h3>‚öôÔ∏è Harakat Parametrlari</h3>
                    
                    <div class="control-group">
                        <label>Boshlang'ich tezlik v‚Çì (m/s) <span class="help-tooltip">?</span></label>
                        <input type="range" id="vxSlider" min="-50" max="50" value="20" step="1">
                        <div class="value-display" id="vxVal">20 m/s</div>
                    </div>

                    <div class="control-group">
                        <label>Boshlang'ich tezlik v·µß (m/s) <span class="help-tooltip">?</span></label>
                        <input type="range" id="vySlider" min="-50" max="50" value="15" step="1">
                        <div class="value-display" id="vyVal">15 m/s</div>
                    </div>

                    <div class="control-group">
                        <label>Tezlanish a‚Çì (m/s¬≤) <span class="help-tooltip">?</span></label>
                        <input type="range" id="axSlider" min="-10" max="10" value="0" step="0.1">
                        <div class="value-display" id="axVal">0.0 m/s¬≤</div>
                    </div>

                    <div class="control-group">
                        <label>Tezlanish a·µß (m/s¬≤) <span class="help-tooltip">?</span></label>
                        <input type="range" id="aySlider" min="-10" max="10" value="-9.8" step="0.1">
                        <div class="value-display" id="ayVal">-9.8 m/s¬≤</div>
                    </div>
                </div>

                <div class="controls-section">
                    <h3>üëÅÔ∏è Ko'rish Sozlamalari</h3>
                    
                    <div class="control-group">
                        <label><input type="checkbox" id="autoScale" checked> Avtomatik masshtablash</label>
                    </div>
                    <div class="control-group">
                        <label><input type="checkbox" id="showGrid" checked> Koordinata to'ri</label>
                    </div>
                    <div class="control-group">
                        <label><input type="checkbox" id="showTrail" checked> Harakat izi</label>
                    </div>
                    <div class="control-group">
                        <label><input type="checkbox" id="showComp" checked> Komponentlar</label>
                    </div>
                </div>

                <div class="controls-section">
                    <h3>‚è±Ô∏è Simulyatsiya Tezligi</h3>
                    <div class="speed-control">
                        <label>Tezlik:</label>
                        <input type="range" id="speedSlider" min="0.1" max="3" value="1" step="0.1" style="flex:1">
                        <div class="speed-display" id="speedVal">1.0x</div>
                    </div>
                </div>

                <div class="controls-section">
                    <h3>üé¨ Tayyor Stsenariylar</h3>
                    <div class="preset-buttons">
                        <button class="preset-btn" data-preset="projectile">üéØ Proyektil</button>
                        <button class="preset-btn" data-preset="circular">‚≠ï Aylana</button>
                        <button class="preset-btn" data-preset="uniform">‚û°Ô∏è Tekis</button>
                        <button class="preset-btn" data-preset="decel">‚¨áÔ∏è Sekinlanish</button>
                    </div>
                </div>

                <div class="vector-info">
                    <h4>üìä Tezlik Ma'lumotlari</h4>
                    <div class="data-display">
                        <div class="data-row">
                            <span class="data-label">v‚Çì:</span>
                            <span class="data-value" id="curVx">20.0 m/s</span>
                        </div>
                        <div class="data-row">
                            <span class="data-label">v·µß:</span>
                            <span class="data-value" id="curVy">15.0 m/s</span>
                        </div>
                        <div class="data-row">
                            <span class="data-label">|v‚Éó|:</span>
                            <span class="data-value" id="curMag">25.0 m/s</span>
                        </div>
                        <div class="data-row">
                            <span class="data-label">Œ∏:</span>
                            <span class="data-value" id="curAng">36.9¬∞</span>
                        </div>
                        <div class="data-row">
                            <span class="data-label">Vaqt:</span>
                            <span class="data-value" id="curTime">0.0 s</span>
                        </div>
                        <div class="data-row">
                            <span class="data-label">Pozitsiya:</span>
                            <span class="data-value" id="curPos">(0, 0)</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="theory-section">
            <h2>üìö Nazariy Asoslar</h2>
            
            <div class="formula-box">
                <h4>Tezlik Vektori Kattaligi</h4>
                <p>$$|\vec{v}| = \sqrt{v_x^2 + v_y^2}$$</p>
                <p>Pifagor teoremasi asosida tezlik vektorining kattaligini hisoblash.</p>
            </div>

            <div class="formula-box">
                <h4>Tezlik Vektori Yo'nalishi</h4>
                <p>$$\theta = \arctan\left(\frac{v_y}{v_x}\right)$$</p>
                <p>Tezlik vektorining gorizontal o'q bilan hosil qilgan burchagi.</p>
            </div>

            <div class="formula-box">
                <h4>Kinematik Tenglamalar</h4>
                <p>$$v_x(t) = v_{0x} + a_x \cdot t$$</p>
                <p>$$v_y(t) = v_{0y} + a_y \cdot t$$</p>
                <p>$$x(t) = x_0 + v_{0x} \cdot t + \frac{1}{2}a_x \cdot t^2$$</p>
                <p>$$y(t) = y_0 + v_{0y} \cdot t + \frac{1}{2}a_y \cdot t^2$$</p>
            </div>

            <h3>üåç Real Hayotdagi Misollar</h3>
            <ul>
                <li><strong>Proyektil harakati:</strong> Top o'qi yoki futbol to'pining harakati</li>
                <li><strong>Aylana harakat:</strong> Planetalarning Quyosh atrofidagi harakati</li>
                <li><strong>Avtomobil harakati:</strong> Egri yo'lda harakatlanuvchi mashina</li>
                <li><strong>Samolyot harakati:</strong> Shamol ta'sirida uchayotgan samolyot</li>
            </ul>
        </div>
    </div>

    <script>
        class Sim {
            constructor() {
                this.c = document.getElementById('canvas');
                this.ctx = this.c.getContext('2d');
                this.setup();
                
                this.run = false;
                this.t = 0;
                this.dt = 0.016;
                this.speed = 1;
                
                this.x0 = 0; this.y0 = 0;
                this.vx0 = 20; this.vy0 = 15;
                this.ax = 0; this.ay = -9.8;
                
                this.reset();
                
                this.scale = 3;
                this.minScale = 0.5; this.maxScale = 20;
                this.ox = this.c.width / 2;
                this.oy = this.c.height / 2;
                this.showGrid = true;
                this.showTrail = true;
                this.trail = [];
                this.maxTrail = 200;
                this.autoScale = true;
                this.buf = 50;
                this.vecScale = 5;
                this.showComp = true;
                
                this.bind();
                this.updateUI();
                this.draw();
            }
            
            setup() {
                const r = this.c.getBoundingClientRect();
                const dpr = window.devicePixelRatio || 1;
                this.c.width = r.width * dpr;
                this.c.height = r.height * dpr;
                this.ctx.scale(dpr, dpr);
                this.c.style.width = r.width + 'px';
                this.c.style.height = r.height + 'px';
            }
            
            bind() {
                document.getElementById('vxSlider').oninput = e => {
                    this.vx0 = +e.target.value;
                    this.fitView();
                    this.updateUI();
                };
                
                document.getElementById('vySlider').oninput = e => {
                    this.vy0 = +e.target.value;
                    this.fitView();
                    this.updateUI();
                };
                
                document.getElementById('axSlider').oninput = e => {
                    this.ax = +e.target.value;
                    this.fitView();
                    this.updateUI();
                };
                
                document.getElementById('aySlider').oninput = e => {
                    this.ay = +e.target.value;
                    this.fitView();
                    this.updateUI();
                };
                
                document.getElementById('speedSlider').oninput = e => {
                    this.speed = +e.target.value;
                    document.getElementById('speedVal').textContent = this.speed.toFixed(1) + 'x';
                };
                
                document.getElementById('playBtn').onclick = () => this.toggle();
                document.getElementById('resetBtn').onclick = () => this.reset();
                document.getElementById('clearBtn').onclick = () => this.trail = [];
                
                document.getElementById('zoomIn').onclick = () => this.scale = Math.min(this.maxScale, this.scale * 1.5);
                document.getElementById('zoomOut').onclick = () => this.scale = Math.max(this.minScale, this.scale / 1.5);
                document.getElementById('fitView').onclick = () => this.fitView();
                
                document.getElementById('autoScale').onchange = e => this.autoScale = e.target.checked;
                document.getElementById('showGrid').onchange = e => this.showGrid = e.target.checked;
                document.getElementById('showTrail').onchange = e => this.showTrail = e.target.checked;
                document.getElementById('showComp').onchange = e => this.showComp = e.target.checked;
                
                document.querySelectorAll('.preset-btn').forEach(b => {
                    b.onclick = e => this.preset(e.target.dataset.preset);
                });
                
                this.c.onclick = e => {
                    const r = this.c.getBoundingClientRect();
                    const x = e.clientX - r.left;
                    const y = e.clientY - r.top;
                    this.setPos(x, y);
                };
                
                this.c.onmousemove = e => {
                    const r = this.c.getBoundingClientRect();
                    const x = (e.clientX - r.left - this.ox) / this.scale;
                    const y = -(e.clientY - r.top - this.oy) / this.scale;
                    document.getElementById('mousePos').textContent = `Kursor: (${x.toFixed(1)}, ${y.toFixed(1)})`;
                };
                
                window.onresize = () => {
                    this.setup();
                    this.fitView();
                };
                
                document.onkeydown = e => {
                    if (e.key === ' ') { e.preventDefault(); this.toggle(); }
                    if (e.key === 'r') this.reset();
                    if (e.key === 'c') this.trail = [];
                };
            }
            
            reset() {
                this.t = 0;
                this.x = this.x0;
                this.y = this.y0;
                this.vx = this.vx0;
                this.vy = this.vy0;
                this.trail = [];
                this.fitView();
                this.updateUI();
            }
            
            toggle() {
                this.run = !this.run;
                document.getElementById('playBtn').textContent = this.run ? '‚è∏Ô∏è Pauza' : '‚ñ∂Ô∏è Boshlash';
                if (this.run) this.animate();
            }
            
            preset(p) {
                const presets = {
                    projectile: { vx0: 20, vy0: 20, ax: 0, ay: -9.8 },
                    circular: { vx0: 15, vy0: 0, ax: 0, ay: 0 },
                    uniform: { vx0: 25, vy0: 0, ax: 0, ay: 0 },
                    decel: { vx0: 30, vy0: 10, ax: -2, ay: -1 }
                };
                
                if (presets[p]) {
                    const pr = presets[p];
                    this.vx0 = pr.vx0; this.vy0 = pr.vy0;
                    this.ax = pr.ax; this.ay = pr.ay;
                    
                    document.getElementById('vxSlider').value = pr.vx0;
                    document.getElementById('vySlider').value = pr.vy0;
                    document.getElementById('axSlider').value = pr.ax;
                    document.getElementById('aySlider').value = pr.ay;
                    
                    this.reset();
                }
            }
            
            setPos(cx, cy) {
                this.x = (cx - this.ox) / this.scale;
                this.y = -(cy - this.oy) / this.scale;
                this.x0 = this.x;
                this.y0 = this.y;
                this.t = 0;
                this.trail = [];
                this.updateUI();
            }
            
            update() {
                if (!this.run) return;
                
                const dt = this.dt * this.speed;
                this.t += dt;
                
                this.vx = this.vx0 + this.ax * this.t;
                this.vy = this.vy0 + this.ay * this.t;
                
                this.x = this.x0 + this.vx0 * this.t + 0.5 * this.ax * this.t * this.t;
                this.y = this.y0 + this.vy0 * this.t + 0.5 * this.ay * this.t * this.t;
                
                if (this.showTrail) {
                    this.trail.push({ x: this.x, y: this.y });
                    if (this.trail.length > this.maxTrail) this.trail.shift();
                }
                
                if (this.autoScale) this.autoFit();
                
                if (Math.abs(this.x) > 500 || Math.abs(this.y) > 500) this.reset();
                
                this.updateUI();
            }
            
            autoFit() {
                let minX = Math.min(this.x, this.x0);
                let maxX = Math.max(this.x, this.x0);
                let minY = Math.min(this.y, this.y0);
                let maxY = Math.max(this.y, this.y0);
                
                this.trail.forEach(p => {
                    minX = Math.min(minX, p.x);
                    maxX = Math.max(maxX, p.x);
                    minY = Math.min(minY, p.y);
                    maxY = Math.max(maxY, p.y);
                });
                
                const vMag = Math.sqrt(this.vx * this.vx + this.vy * this.vy);
                const buf = Math.max(10, vMag * 2);
                
                minX -= buf; maxX += buf;
                minY -= buf; maxY += buf;
                
                const rx = maxX - minX;
                const ry = maxY - minY;
                const cx = (minX + maxX) / 2;
                const cy = (minY + maxY) / 2;
                
                const sx = (this.c.width - 2 * this.buf) / rx;
                const sy = (this.c.height - 2 * this.buf) / ry;
                const ts = Math.min(sx, sy);
                
                const ns = Math.max(this.minScale, Math.min(this.maxScale, ts));
                this.scale = this.scale * 0.95 + ns * 0.05;
                
                this.ox = this.c.width / 2 - cx * this.scale;
                this.oy = this.c.height / 2 + cy * this.scale;
                
                this.vecScale = Math.max(1, Math.min(20, 50 / Math.max(1, vMag)));
            }
            
            fitView() {
                const vMag = Math.sqrt(this.vx0 * this.vx0 + this.vy0 * this.vy0);
                let est = 50;
                
                if (this.ay !== 0) {
                    const tMax = Math.abs(this.vy0 / this.ay);
                    const hMax = Math.abs(this.y0 + this.vy0 * tMax + 0.5 * this.ay * tMax * tMax);
                    const tTot = 2 * tMax;
                    const rMax = Math.abs(this.x0 + this.vx0 * tTot + 0.5 * this.ax * tTot * tTot);
                    est = Math.max(hMax, rMax);
                }
                
                if (this.ax !== 0 || this.ay !== 0) {
                    const te = Math.max(5, vMag / Math.max(1, Math.sqrt(this.ax * this.ax + this.ay * this.ay)));
                    const xr = Math.abs(this.vx0 * te + 0.5 * this.ax * te * te);
                    const yr = Math.abs(this.vy0 * te + 0.5 * this.ay * te * te);
                    est = Math.max(xr, yr);
                }
                
                est *= 1.5;
                
                const sx = (this.c.width - 2 * this.buf) / (2 * est);
                const sy = (this.c.height - 2 * this.buf) / (2 * est);
                this.scale = Math.max(this.minScale, Math.min(this.maxScale, Math.min(sx, sy)));
                
                this.ox = this.c.width / 2;
                this.oy = this.c.height / 2;
                
                this.vecScale = Math.max(1, Math.min(20, 50 / Math.max(1, vMag)));
            }
            
            updateUI() {
                document.getElementById('vxVal').textContent = this.vx0.toFixed(1) + ' m/s';
                document.getElementById('vyVal').textContent = this.vy0.toFixed(1) + ' m/s';
                document.getElementById('axVal').textContent = this.ax.toFixed(1) + ' m/s¬≤';
                document.getElementById('ayVal').textContent = this.ay.toFixed(1) + ' m/s¬≤';
                
                document.getElementById('curVx').textContent = this.vx.toFixed(1) + ' m/s';
                document.getElementById('curVy').textContent = this.vy.toFixed(1) + ' m/s';
                
                const mag = Math.sqrt(this.vx * this.vx + this.vy * this.vy);
                document.getElementById('curMag').textContent = mag.toFixed(1) + ' m/s';
                
                const ang = Math.atan2(this.vy, this.vx) * 180 / Math.PI;
                document.getElementById('curAng').textContent = ang.toFixed(1) + '¬∞';
                
                document.getElementById('curTime').textContent = this.t.toFixed(1) + ' s';
                document.getElementById('curPos').textContent = `(${this.x.toFixed(1)}, ${this.y.toFixed(1)})`;
                
                const sr = this.scale.toFixed(2);
                const mpp = (1 / this.scale).toFixed(2);
                document.getElementById('scaleInfo').textContent = `Masshtab: ${sr} px/m (${mpp} m/px)`;
            }
            
            draw() {
                this.ctx.clearRect(0, 0, this.c.width, this.c.height);
                
                if (this.showGrid) this.drawGrid();
                if (this.showTrail && this.trail.length > 1) this.drawTrail();
                
                this.drawAxes();
                this.drawParticle();
                this.drawVectors();
                this.drawLegend();
            }
            
            drawGrid() {
                const gs = 50;
                const gps = gs * this.scale;
                
                if (gps < 10 || gps > 200) return;
                
                this.ctx.strokeStyle = 'rgba(0,0,0,0.1)';
                this.ctx.lineWidth = 1;
                
                const minX = Math.floor(-this.ox / gps) * gps;
                const maxX = Math.ceil((this.c.width - this.ox) / gps) * gps;
                const minY = Math.floor(-this.oy / gps) * gps;
                const maxY = Math.ceil((this.c.height - this.oy) / gps) * gps;
                
                for (let x = minX; x <= maxX; x += gps) {
                    const sx = this.ox + x;
                    this.ctx.beginPath();
                    this.ctx.moveTo(sx, 0);
                    this.ctx.lineTo(sx, this.c.height);
                    this.ctx.stroke();
                }
                
                for (let y = minY; y <= maxY; y += gps) {
                    const sy = this.oy + y;
                    this.ctx.beginPath();
                    this.ctx.moveTo(0, sy);
                    this.ctx.lineTo(this.c.width, sy);
                    this.ctx.stroke();
                }
                
                this.ctx.fillStyle = 'rgba(0,0,0,0.5)';
                this.ctx.font = '10px Arial';
                
                for (let x = minX; x <= maxX; x += gps) {
                    if (x === 0) continue;
                    const sx = this.ox + x;
                    const v = Math.round(x / this.scale);
                    if (sx > 20 && sx < this.c.width - 20) {
                        this.ctx.fillText(v, sx - 5, this.oy + 15);
                    }
                }
                
                for (let y = minY; y <= maxY; y += gps) {
                    if (y === 0) continue;
                    const sy = this.oy + y;
                    const v = Math.round(-y / this.scale);
                    if (sy > 15 && sy < this.c.height - 15) {
                        this.ctx.fillText(v, this.ox + 5, sy + 3);
                    }
                }
            }
            
            drawAxes() {
                this.ctx.strokeStyle = '#333';
                this.ctx.lineWidth = 2;
                
                this.ctx.beginPath();
                this.ctx.moveTo(0, this.oy);
                this.ctx.lineTo(this.c.width, this.oy);
                this.ctx.stroke();
                
                this.ctx.beginPath();
                this.ctx.moveTo(this.ox, 0);
                this.ctx.lineTo(this.ox, this.c.height);
                this.ctx.stroke();
                
                this.ctx.fillStyle = '#333';
                this.ctx.font = '14px Arial';
                this.ctx.fillText('X', this.c.width - 20, this.oy - 10);
                this.ctx.fillText('Y', this.ox + 10, 20);
            }
            
            drawTrail() {
                if (this.trail.length < 2) return;
                
                this.ctx.strokeStyle = '#667eea';
                this.ctx.lineWidth = 2;
                this.ctx.globalAlpha = 0.3;
                
                this.ctx.beginPath();
                const fp = this.trail[0];
                this.ctx.moveTo(this.ox + fp.x * this.scale, this.oy - fp.y * this.scale);
                
                for (let i = 1; i < this.trail.length; i++) {
                    const p = this.trail[i];
                    this.ctx.lineTo(this.ox + p.x * this.scale, this.oy - p.y * this.scale);
                }
                
                this.ctx.stroke();
                this.ctx.globalAlpha = 1;
            }
            
            drawParticle() {
                const sx = this.ox + this.x * this.scale;
                const sy = this.oy - this.y * this.scale;
                
                this.ctx.fillStyle = '#e53e3e';
                this.ctx.beginPath();
                this.ctx.arc(sx, sy, 8, 0, 2 * Math.PI);
                this.ctx.fill();
                
                this.ctx.strokeStyle = '#fff';
                this.ctx.lineWidth = 2;
                this.ctx.stroke();
            }
            
            drawVectors() {
                const sx = this.ox + this.x * this.scale;
                const sy = this.oy - this.y * this.scale;
                
                if (this.showComp) {
                    this.drawVec(sx, sy, this.vx * this.vecScale, 0, '#ff6b6b', 'v‚Çì');
                    this.drawVec(sx, sy, 0, -this.vy * this.vecScale, '#4ecdc4', 'v·µß');
                }
                
                this.drawVec(sx, sy, this.vx * this.vecScale, -this.vy * this.vecScale, '#667eea', 'v‚Éó');
            }
            
            drawVec(sx, sy, dx, dy, col, lbl) {
                if (Math.abs(dx) < 0.1 && Math.abs(dy) < 0.1) return;
                
                const ex = sx + dx;
                const ey = sy + dy;
                
                this.ctx.strokeStyle = col;
                this.ctx.fillStyle = col;
                this.ctx.lineWidth = 3;
                
                this.ctx.beginPath();
                this.ctx.moveTo(sx, sy);
                this.ctx.lineTo(ex, ey);
                this.ctx.stroke();
                
                const ang = Math.atan2(dy, dx);
                const al = 10;
                const aa = Math.PI / 6;
                
                this.ctx.beginPath();
                this.ctx.moveTo(ex, ey);
                this.ctx.lineTo(ex - al * Math.cos(ang - aa), ey - al * Math.sin(ang - aa));
                this.ctx.lineTo(ex - al * Math.cos(ang + aa), ey - al * Math.sin(ang + aa));
                this.ctx.closePath();
                this.ctx.fill();
                
                this.ctx.fillStyle = col;
                this.ctx.font = 'bold 14px Arial';
                this.ctx.fillText(lbl, ex + 5, ey - 5);
            }
            
            drawLegend() {
                const lx = 10, ly = 10;
                
                this.ctx.fillStyle = 'rgba(255,255,255,0.9)';
                this.ctx.fillRect(lx, ly, 200, 100);
                
                this.ctx.strokeStyle = '#ccc';
                this.ctx.lineWidth = 1;
                this.ctx.strokeRect(lx, ly, 200, 100);
                
                this.ctx.fillStyle = '#333';
                this.ctx.font = '12px Arial';
                this.ctx.fillText('Legendlar:', lx + 10, ly + 20);
                
                const items = [
                    { col: '#ff6b6b', lbl: 'v‚Çì - Gorizontal tezlik' },
                    { col: '#4ecdc4', lbl: 'v·µß - Vertikal tezlik' },
                    { col: '#667eea', lbl: 'v‚Éó - Natija tezlik' }
                ];
                
                items.forEach((it, i) => {
                    const y = ly + 40 + i * 20;
                    
                    this.ctx.fillStyle = it.col;
                    this.ctx.fillRect(lx + 10, y - 8, 15, 3);
                    
                    this.ctx.fillStyle = '#333';
                    this.ctx.fillText(it.lbl, lx + 30, y);
                });
            }
            
            animate() {
                this.update();
                this.draw();
                if (this.run) requestAnimationFrame(() => this.animate());
            }
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            new Sim();
        });
    </script>
</body>
</html>
