<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mexanik ish - Mobil</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Segoe UI', Tahoma, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
            touch-action: pan-y;
        }

        .container {
            max-width: 100%;
            padding: 10px;
        }

        .header {
            text-align: center;
            margin-bottom: 15px;
            background: rgba(255, 255, 255, 0.95);
            padding: 15px 10px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }

        .header h1 {
            color: #2c3e50;
            font-size: 1.5em;
            margin-bottom: 5px;
        }

        .header p {
            font-size: 0.9em;
            color: #7f8c8d;
        }

        .canvas-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            padding: 10px;
            margin-bottom: 15px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }

        canvas {
            width: 100%;
            height: auto;
            border: 2px solid #3498db;
            border-radius: 8px;
            display: block;
            background: #f8f9fa;
            touch-action: none;
        }

        .work-display {
            background: linear-gradient(45deg, #3498db, #2ecc71);
            color: white;
            padding: 12px;
            border-radius: 10px;
            text-align: center;
            margin: 10px 0;
            font-size: 1.1em;
            font-weight: 600;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
        }

        .work-type {
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            font-weight: 600;
            margin-bottom: 10px;
            font-size: 0.95em;
        }

        .work-positive { background: #2ecc71; color: white; }
        .work-negative { background: #e74c3c; color: white; }
        .work-zero { background: #95a5a6; color: white; }

        .controls {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }

        .btn-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-bottom: 15px;
        }

        .btn {
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 0.95em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            touch-action: manipulation;
        }

        .btn:active {
            transform: scale(0.95);
        }

        .btn-primary { background: linear-gradient(45deg, #3498db, #2980b9); color: white; }
        .btn-secondary { background: linear-gradient(45deg, #95a5a6, #7f8c8d); color: white; }
        .btn-success { background: linear-gradient(45deg, #2ecc71, #27ae60); color: white; }
        .btn-danger { background: linear-gradient(45deg, #e74c3c, #c0392b); color: white; }

        .preset-btns {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 6px;
            margin-bottom: 15px;
        }

        .preset-btn {
            padding: 8px;
            border: none;
            border-radius: 6px;
            font-size: 0.85em;
            cursor: pointer;
            background: #ecf0f1;
            color: #2c3e50;
            font-weight: 600;
            touch-action: manipulation;
        }

        .preset-btn:active {
            background: #3498db;
            color: white;
        }

        .control-group {
            margin-bottom: 15px;
        }

        .control-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 600;
            color: #2c3e50;
            font-size: 0.95em;
        }

        input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: #ddd;
            outline: none;
            -webkit-appearance: none;
            appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #3498db;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }

        input[type="range"]::-moz-range-thumb {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #3498db;
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }

        .value-display {
            background: #ecf0f1;
            padding: 8px;
            border-radius: 6px;
            text-align: center;
            font-weight: 600;
            color: #2c3e50;
            margin-top: 5px;
            font-size: 0.95em;
        }

        .info-box {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 8px;
            margin-top: 10px;
            font-size: 0.9em;
        }

        .info-box > div {
            margin-bottom: 5px;
        }

        .formula-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }

        .formula-section h3 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .formula-box {
            background: #f8f9fa;
            border-left: 4px solid #3498db;
            padding: 12px;
            margin: 10px 0;
            border-radius: 0 8px 8px 0;
            font-size: 0.9em;
        }

        .formula-box h4 {
            margin-bottom: 8px;
            color: #2c3e50;
        }

        .theory-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }

        .theory-section h3 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .theory-card {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 8px;
            border-left: 4px solid #3498db;
            margin-bottom: 10px;
            font-size: 0.9em;
        }

        .theory-card h4 {
            color: #2c3e50;
            margin-bottom: 6px;
        }

        .chart-container {
            background: white;
            border-radius: 10px;
            padding: 10px;
            margin-top: 10px;
        }

        .chart-canvas {
            width: 100%;
            height: auto;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        @media (max-width: 320px) {
            .header h1 { font-size: 1.3em; }
            .btn { padding: 10px; font-size: 0.85em; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‚öôÔ∏è Mexanik ish</h1>
            <p>Interaktiv simulyatsiya</p>
        </div>

        <div class="canvas-container">
            <canvas id="simCanvas" width="400" height="300"></canvas>
        </div>

        <div class="work-display">
            Mexanik ish: <span id="workVal">0</span> J
        </div>

        <div id="workType" class="work-type work-zero">
            Nol ish (Œ∏ = 90¬∞)
        </div>

        <div class="controls">
            <div class="btn-group">
                <button class="btn btn-primary" onclick="start()">‚ñ∂Ô∏è Boshlash</button>
                <button class="btn btn-secondary" onclick="pause()">‚è∏Ô∏è Pauza</button>
                <button class="btn btn-success" onclick="reset()">üîÑ Reset</button>
                <button class="btn btn-danger" onclick="exportData()">üíæ Eksport</button>
            </div>

            <div class="preset-btns">
                <button class="preset-btn" onclick="setPreset('positive')">Ijobiy</button>
                <button class="preset-btn" onclick="setPreset('negative')">Salbiy</button>
                <button class="preset-btn" onclick="setPreset('zero')">Nol</button>
            </div>

            <div class="control-group">
                <label>Kuch (F): <span id="forceVal">50</span> N</label>
                <input type="range" id="force" min="0" max="100" value="50">
            </div>

            <div class="control-group">
                <label>Burchak (Œ∏): <span id="angleVal">0</span>¬∞</label>
                <input type="range" id="angle" min="0" max="180" value="0">
            </div>

            <div class="control-group">
                <label>Masofa (s): <span id="distVal">5.0</span> m</label>
                <input type="range" id="distance" min="0" max="10" value="5" step="0.1">
            </div>

            <div class="control-group">
                <label>Tezlik: <span id="speedVal">1.0</span>x</label>
                <input type="range" id="speed" min="0.1" max="3" value="1" step="0.1">
            </div>

            <div class="info-box">
                <div><strong>cos(Œ∏):</strong> <span id="cosVal">1.000</span></div>
                <div><strong>F¬∑cos(Œ∏):</strong> <span id="effForce">50.0</span> N</div>
                <div><strong>Ish:</strong> <span id="curWork">0.0</span> J</div>
            </div>
        </div>

        <div class="chart-container">
            <h4 style="margin-bottom: 10px; color: #2c3e50;">Ish-Masofa grafigi</h4>
            <canvas id="chart" width="350" height="180" class="chart-canvas"></canvas>
        </div>

        <div class="formula-section">
            <h3>üìê Formulalar</h3>
            <div class="formula-box">
                <h4>Mexanik ish:</h4>
                <p>$$W = F \cdot s \cdot \cos\theta$$</p>
                <p style="margin-top: 8px; font-size: 0.85em;">W - ish (J), F - kuch (N), s - masofa (m), Œ∏ - burchak</p>
            </div>
            <div class="formula-box">
                <h4>Ish turlari:</h4>
                <p>‚Ä¢ <strong>Ijobiy:</strong> Œ∏ < 90¬∞ (harakat yo'nalishida)<br>
                ‚Ä¢ <strong>Salbiy:</strong> Œ∏ > 90¬∞ (qarama-qarshi)<br>
                ‚Ä¢ <strong>Nol:</strong> Œ∏ = 90¬∞ (perpendikulyar)</p>
            </div>
        </div>

        <div class="theory-section">
            <h3>üìö Nazariya</h3>
            <div class="theory-card">
                <h4>Mexanik ish nima?</h4>
                <p>Kuch ta'sirida jism ko'chganda bajarilgan ish. Ish kuch va ko'chish vektorlarining skalyar ko'paytmasi.</p>
            </div>
            <div class="theory-card">
                <h4>Birlik: Joule (J)</h4>
                <p>1 J = 1 N¬∑m. 1 Nyuton kuch ta'sirida 1 metr ko'chish.</p>
            </div>
            <div class="theory-card">
                <h4>Burchak ahamiyati</h4>
                <p>0¬∞ - maksimal ish, 90¬∞ - nol ish, 180¬∞ - maksimal salbiy ish.</p>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('simCanvas');
        const ctx = canvas.getContext('2d');
        const chartCanvas = document.getElementById('chart');
        const chartCtx = chartCanvas.getContext('2d');

        let animId, isAnim = false, pos = 0, speed = 1;
        let workHist = [], timeHist = [], time = 0;

        const force = document.getElementById('force');
        const angle = document.getElementById('angle');
        const distance = document.getElementById('distance');
        const speedSlider = document.getElementById('speed');

        force.oninput = angle.oninput = distance.oninput = update;
        speedSlider.oninput = () => {
            speed = parseFloat(speedSlider.value);
            document.getElementById('speedVal').textContent = speed.toFixed(1);
        };

        function update() {
            const f = parseFloat(force.value);
            const a = parseFloat(angle.value);
            const d = parseFloat(distance.value);
            const rad = a * Math.PI / 180;

            document.getElementById('forceVal').textContent = f;
            document.getElementById('angleVal').textContent = a;
            document.getElementById('distVal').textContent = d.toFixed(1);

            const cos = Math.cos(rad);
            const eff = f * cos;
            const w = eff * d;

            document.getElementById('cosVal').textContent = cos.toFixed(3);
            document.getElementById('effForce').textContent = eff.toFixed(1);
            document.getElementById('curWork').textContent = w.toFixed(1);
            document.getElementById('workVal').textContent = w.toFixed(1);

            const wt = document.getElementById('workType');
            if (Math.abs(w) < 0.1) {
                wt.className = 'work-type work-zero';
                wt.textContent = 'Nol ish (Œ∏ ‚âà 90¬∞)';
            } else if (w > 0) {
                wt.className = 'work-type work-positive';
                wt.textContent = 'Ijobiy ish (Œ∏ < 90¬∞)';
            } else {
                wt.className = 'work-type work-negative';
                wt.textContent = 'Salbiy ish (Œ∏ > 90¬∞)';
            }

            if (!isAnim) draw();
        }

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            const f = parseFloat(force.value);
            const a = parseFloat(angle.value);
            const d = parseFloat(distance.value);
            const rad = a * Math.PI / 180;

            const size = 30;
            const startX = 40;
            const startY = canvas.height / 2;
            const maxDist = canvas.width - 80;
            const blockX = startX + (pos / d) * (maxDist - startX);

            ctx.fillStyle = '#8B4513';
            ctx.fillRect(0, startY + size/2, canvas.width, 15);

            ctx.fillStyle = '#3498db';
            ctx.fillRect(blockX - size/2, startY - size/2, size, size);
            ctx.strokeStyle = '#2980b9';
            ctx.lineWidth = 2;
            ctx.strokeRect(blockX - size/2, startY - size/2, size, size);

            const scale = 1.5;
            const len = f * scale;
            const endX = blockX + len * Math.cos(rad);
            const endY = startY - len * Math.sin(rad);

            ctx.beginPath();
            ctx.moveTo(blockX, startY);
            ctx.lineTo(endX, endY);
            ctx.strokeStyle = '#e74c3c';
            ctx.lineWidth = 2.5;
            ctx.stroke();
            arrow(ctx, blockX, startY, endX, endY, '#e74c3c');

            ctx.beginPath();
            ctx.moveTo(blockX, startY + size/2 + 8);
            ctx.lineTo(blockX + 50, startY + size/2 + 8);
            ctx.strokeStyle = '#2ecc71';
            ctx.lineWidth = 2;
            ctx.stroke();
            arrow(ctx, blockX, startY + size/2 + 8, blockX + 50, startY + size/2 + 8, '#2ecc71');

            ctx.beginPath();
            ctx.arc(blockX, startY, 25, 0, -rad, rad > 0);
            ctx.strokeStyle = '#9b59b6';
            ctx.lineWidth = 1.5;
            ctx.stroke();

            ctx.fillStyle = '#2c3e50';
            ctx.font = '11px Arial';
            ctx.fillText(`F=${f}N`, endX + 3, endY - 3);
            ctx.fillText(`Œ∏=${a}¬∞`, blockX + 15, startY - 15);
            ctx.fillText(`${pos.toFixed(1)}m`, blockX, startY + size/2 + 25);

            const eff = f * Math.cos(rad);
            if (Math.abs(eff) > 0.1) {
                ctx.beginPath();
                ctx.moveTo(blockX, startY);
                ctx.lineTo(blockX + eff * scale, startY);
                ctx.strokeStyle = '#f39c12';
                ctx.lineWidth = 2;
                ctx.stroke();
            }
        }

        function arrow(ctx, x1, y1, x2, y2, col) {
            const len = 8;
            const ang = Math.atan2(y2 - y1, x2 - x1);
            ctx.strokeStyle = ctx.fillStyle = col;
            ctx.beginPath();
            ctx.moveTo(x2, y2);
            ctx.lineTo(x2 - len * Math.cos(ang - Math.PI/6), y2 - len * Math.sin(ang - Math.PI/6));
            ctx.moveTo(x2, y2);
            ctx.lineTo(x2 - len * Math.cos(ang + Math.PI/6), y2 - len * Math.sin(ang + Math.PI/6));
            ctx.stroke();
        }

        function start() {
            if (!isAnim) {
                isAnim = true;
                pos = time = 0;
                workHist = [];
                timeHist = [];
                animate();
            }
        }

        function pause() {
            isAnim = false;
            if (animId) cancelAnimationFrame(animId);
        }

        function reset() {
            pause();
            pos = time = 0;
            workHist = [];
            timeHist = [];
            draw();
            drawChart();
        }

        function animate() {
            if (!isAnim) return;

            const d = parseFloat(distance.value);
            const f = parseFloat(force.value);
            const rad = parseFloat(angle.value) * Math.PI / 180;

            if (pos < d) {
                pos += 0.05 * speed;
                time += 0.05;
                const w = f * Math.cos(rad) * pos;
                workHist.push(w);
                timeHist.push(time);
                draw();
                drawChart();
                animId = requestAnimationFrame(animate);
            } else {
                isAnim = false;
            }
        }

        function drawChart() {
            chartCtx.clearRect(0, 0, chartCanvas.width, chartCanvas.height);
            if (workHist.length < 2) return;

            const max = Math.max(...workHist.map(Math.abs));
            const w = chartCanvas.width - 50;
            const h = chartCanvas.height - 50;
            const x = 35;
            const y = 15;

            chartCtx.strokeStyle = '#34495e';
            chartCtx.lineWidth = 1.5;
            chartCtx.beginPath();
            chartCtx.moveTo(x, y);
            chartCtx.lineTo(x, y + h);
            chartCtx.lineTo(x + w, y + h);
            chartCtx.stroke();

            chartCtx.strokeStyle = '#3498db';
            chartCtx.lineWidth = 2;
            chartCtx.beginPath();
            for (let i = 0; i < workHist.length; i++) {
                const px = x + (i / (workHist.length - 1)) * w;
                const py = y + h - (workHist[i] / max) * h * 0.8;
                i === 0 ? chartCtx.moveTo(px, py) : chartCtx.lineTo(px, py);
            }
            chartCtx.stroke();

            chartCtx.fillStyle = '#2c3e50';
            chartCtx.font = '10px Arial';
            chartCtx.fillText('W(J)', 5, y + 10);
            chartCtx.fillText('s(m)', x + w - 20, y + h + 12);
        }

        function setPreset(type) {
            const presets = {
                positive: [80, 30, 6],
                negative: [60, 150, 4],
                zero: [70, 90, 5]
            };
            const [f, a, d] = presets[type];
            force.value = f;
            angle.value = a;
            distance.value = d;
            update();
        }

        function exportData() {
            const data = {
                force: parseFloat(force.value),
                angle: parseFloat(angle.value),
                distance: parseFloat(distance.value),
                work: parseFloat(document.getElementById('curWork').textContent),
                workHistory: workHist,
                timeHistory: timeHist
            };
            const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'mexanik_ish.json';
            a.click();
            URL.revokeObjectURL(url);
        }

        document.addEventListener('keydown', e => {
            if (e.key === ' ') {
                e.preventDefault();
                isAnim ? pause() : start();
            } else if (e.key === 'r') reset();
        });

        window.onload = () => {
            update();
            draw();
            drawChart();
        };

        function resizeCanvas() {
            const w = Math.min(400, window.innerWidth - 40);
            canvas.width = w;
            canvas.height = w * 0.75;
            chartCanvas.width = Math.min(350, window.innerWidth - 60);
            chartCanvas.height = 180;
            draw();
            drawChart();
        }

        window.onresize = resizeCanvas;
        resizeCanvas();
    </script>
</body>
</html>
