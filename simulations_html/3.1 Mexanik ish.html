<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3.1 Mexanik ish - Interaktiv Simulyatsiya</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            }
        };
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }

        .header h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .header p {
            font-size: 1.2em;
            color: #7f8c8d;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 20px;
            margin-bottom: 30px;
        }

        .simulation-panel {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
        }

        .controls-panel {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
        }

        .canvas-container {
            position: relative;
            margin-bottom: 20px;
        }

        canvas {
            border: 2px solid #3498db;
            border-radius: 10px;
            display: block;
            margin: 0 auto;
            background: #f8f9fa;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .control-group {
            margin-bottom: 20px;
        }

        .control-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }

        .slider-container {
            position: relative;
            margin-bottom: 10px;
        }

        input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: #ddd;
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #3498db;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #3498db;
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .value-display {
            background: #ecf0f1;
            padding: 8px 12px;
            border-radius: 5px;
            text-align: center;
            font-weight: 600;
            color: #2c3e50;
            margin-top: 5px;
        }

        .work-display {
            background: linear-gradient(45deg, #3498db, #2ecc71);
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.2em;
            font-weight: 600;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .work-type {
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .work-positive {
            background: #2ecc71;
            color: white;
        }

        .work-negative {
            background: #e74c3c;
            color: white;
        }

        .work-zero {
            background: #95a5a6;
            color: white;
        }

        .controls-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 20px;
        }

        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .btn-primary {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
        }

        .btn-secondary {
            background: linear-gradient(45deg, #95a5a6, #7f8c8d);
            color: white;
        }

        .btn-success {
            background: linear-gradient(45deg, #2ecc71, #27ae60);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .btn:active {
            transform: translateY(0);
        }

        .formula-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }

        .formula-section h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .formula-box {
            background: #f8f9fa;
            border-left: 4px solid #3498db;
            padding: 15px;
            margin: 10px 0;
            border-radius: 0 8px 8px 0;
        }

        .theory-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }

        .theory-section h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .theory-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .theory-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #3498db;
        }

        .theory-card h4 {
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .chart-container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .chart-canvas {
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        .preset-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }

        .preset-btn {
            padding: 8px 12px;
            border: none;
            border-radius: 6px;
            font-size: 0.9em;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #ecf0f1;
            color: #2c3e50;
        }

        .preset-btn:hover {
            background: #3498db;
            color: white;
        }

        .help-tooltip {
            position: relative;
            display: inline-block;
            cursor: help;
            margin-left: 5px;
        }

        .help-tooltip .tooltip-text {
            visibility: hidden;
            width: 200px;
            background-color: #2c3e50;
            color: white;
            text-align: center;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.9em;
        }

        .help-tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .controls-grid {
                grid-template-columns: 1fr;
            }
            
            .theory-grid {
                grid-template-columns: 1fr;
            }
            
            canvas {
                width: 100%;
                height: auto;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
            
            .btn {
                padding: 10px 15px;
                font-size: 0.9em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>3.1 Mexanik ish</h1>
            <p>Interaktiv simulyatsiya: Kuch va harakat o'rtasidagi bog'liqlik</p>
        </div>

        <div class="main-content">
            <div class="simulation-panel">
                <div class="canvas-container">
                    <canvas id="simulationCanvas" width="600" height="400"></canvas>
                </div>
                
                <div class="work-display">
                    <div>Mexanik ish: <span id="workValue">0</span> J</div>
                </div>
                
                <div id="workType" class="work-type work-zero">
                    Nol ish (Œ∏ = 90¬∞)
                </div>

                <div class="controls-grid">
                    <button class="btn btn-primary" onclick="startAnimation()">üé¨ Boshlash</button>
                    <button class="btn btn-secondary" onclick="pauseAnimation()">‚è∏Ô∏è Pauza</button>
                    <button class="btn btn-success" onclick="resetAnimation()">üîÑ Qayta boshlash</button>
                    <button class="btn btn-danger" onclick="exportData()">üìä Ma'lumot eksport</button>
                </div>

                <div class="chart-container">
                    <h4>Ish-Masofa grafigi</h4>
                    <canvas id="chartCanvas" width="500" height="200" class="chart-canvas"></canvas>
                </div>
            </div>

            <div class="controls-panel">
                <h3>Parametrlar</h3>
                
                <div class="preset-buttons">
                    <button class="preset-btn" onclick="setPreset('positive')">Ijobiy ish</button>
                    <button class="preset-btn" onclick="setPreset('negative')">Salbiy ish</button>
                    <button class="preset-btn" onclick="setPreset('zero')">Nol ish</button>
                </div>

                <div class="control-group">
                    <label for="forceSlider">
                        Kuch (F) 
                        <span class="help-tooltip">‚ùì
                            <span class="tooltip-text">Jismga ta'sir etuvchi kuch kattaligi. Nyuton (N) birligida o'lchanadi.</span>
                        </span>
                    </label>
                    <div class="slider-container">
                        <input type="range" id="forceSlider" min="0" max="100" value="50" step="1">
                        <div class="value-display"><span id="forceValue">50</span> N</div>
                    </div>
                </div>

                <div class="control-group">
                    <label for="angleSlider">
                        Burchak (Œ∏) 
                        <span class="help-tooltip">‚ùì
                            <span class="tooltip-text">Kuch yo'nalishi va harakat yo'nalishi orasidagi burchak. Gradusda o'lchanadi.</span>
                        </span>
                    </label>
                    <div class="slider-container">
                        <input type="range" id="angleSlider" min="0" max="180" value="0" step="1">
                        <div class="value-display"><span id="angleValue">0</span>¬∞</div>
                    </div>
                </div>

                <div class="control-group">
                    <label for="distanceSlider">
                        Masofa (s) 
                        <span class="help-tooltip">‚ùì
                            <span class="tooltip-text">Jism bosib o'tgan masofa. Metr (m) birligida o'lchanadi.</span>
                        </span>
                    </label>
                    <div class="slider-container">
                        <input type="range" id="distanceSlider" min="0" max="10" value="5" step="0.1">
                        <div class="value-display"><span id="distanceValue">5.0</span> m</div>
                    </div>
                </div>

                <div class="control-group">
                    <label for="speedSlider">
                        Animatsiya tezligi 
                        <span class="help-tooltip">‚ùì
                            <span class="tooltip-text">Simulyatsiya animatsiyasining tezligi. 0.1x dan 5x gacha.</span>
                        </span>
                    </label>
                    <div class="slider-container">
                        <input type="range" id="speedSlider" min="0.1" max="5" value="1" step="0.1">
                        <div class="value-display"><span id="speedValue">1.0</span>x</div>
                    </div>
                </div>

                <div class="control-group">
                    <label>Hozirgi qiymatlar:</label>
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-top: 10px;">
                        <div><strong>cos(Œ∏):</strong> <span id="cosValue">1.000</span></div>
                        <div><strong>F¬∑cos(Œ∏):</strong> <span id="effectiveForce">50.0</span> N</div>
                        <div><strong>Bajarilgan ish:</strong> <span id="currentWork">0.0</span> J</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="formula-section">
            <h3>Asosiy formulalar</h3>
            <div class="formula-box">
                <h4>Mexanik ish formulasi:</h4>
                <p>$$W = \vec{F} \cdot \vec{s} = F \cdot s \cdot \cos\theta$$</p>
                <p>Bu yerda: W - ish (J), F - kuch (N), s - masofa (m), Œ∏ - burchak (¬∞)</p>
            </div>
            
            <div class="formula-box">
                <h4>Ish turlari:</h4>
                <p>‚Ä¢ <strong>Ijobiy ish:</strong> Œ∏ < 90¬∞ (kuch harakat yo'nalishida)</p>
                <p>‚Ä¢ <strong>Salbiy ish:</strong> Œ∏ > 90¬∞ (kuch harakat yo'nalishiga qarama-qarshi)</p>
                <p>‚Ä¢ <strong>Nol ish:</strong> Œ∏ = 90¬∞ (kuch harakat yo'nalishiga perpendikulyar)</p>
            </div>
        </div>

        <div class="theory-section">
            <h3>Nazariy ma'lumotlar</h3>
            <div class="theory-grid">
                <div class="theory-card">
                    <h4>Mexanik ish nima?</h4>
                    <p>Mexanik ish - bu kuch ta'sirida jismning ko'chishi natijasida bajarilgan ish. Ish kuch va ko'chish vektorlarining skalyar ko'paytmasi sifatida hisoblanadi.</p>
                </div>
                
                <div class="theory-card">
                    <h4>Ish birligi</h4>
                    <p>Mexanik ishning SI tizimidagi birligi - Joule (J). 1 J = 1 N¬∑m. Bu 1 Nyuton kuch ta'sirida jismning 1 metr ko'chishida bajarilgan ishga teng.</p>
                </div>
                
                <div class="theory-card">
                    <h4>Burchak ahamiyati</h4>
                    <p>Kuch yo'nalishi va harakat yo'nalishi orasidagi burchak ish miqdorini belgilaydi. Burchak 0¬∞ da maksimal, 90¬∞ da nol, 180¬∞ da maksimal salbiy ish bajariladi.</p>
                </div>
                
                <div class="theory-card">
                    <h4>Hayotiy misollar</h4>
                    <p>‚Ä¢ Yukni gorizontal ko'tarish - ijobiy ish<br>
                    ‚Ä¢ Yukni pastga tushirish - salbiy ish<br>
                    ‚Ä¢ Yukni gorizontal ko'chirish - nol ish (og'irlik kuchi uchun)</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Canvas va kontekstlar
        const canvas = document.getElementById('simulationCanvas');
        const ctx = canvas.getContext('2d');
        const chartCanvas = document.getElementById('chartCanvas');
        const chartCtx = chartCanvas.getContext('2d');

        // Simulyatsiya parametrlari
        let animationId;
        let isAnimating = false;
        let currentPosition = 0;
        let animationSpeed = 1;
        let workHistory = [];
        let timeHistory = [];
        let currentTime = 0;

        // DOM elementlari
        const forceSlider = document.getElementById('forceSlider');
        const angleSlider = document.getElementById('angleSlider');
        const distanceSlider = document.getElementById('distanceSlider');
        const speedSlider = document.getElementById('speedSlider');

        // Qiymat ko'rsatuvchi elementlar
        const forceValue = document.getElementById('forceValue');
        const angleValue = document.getElementById('angleValue');
        const distanceValue = document.getElementById('distanceValue');
        const speedValue = document.getElementById('speedValue');
        const workValue = document.getElementById('workValue');
        const cosValue = document.getElementById('cosValue');
        const effectiveForce = document.getElementById('effectiveForce');
        const currentWork = document.getElementById('currentWork');
        const workType = document.getElementById('workType');

        // Event listenerlar
        forceSlider.addEventListener('input', updateValues);
        angleSlider.addEventListener('input', updateValues);
        distanceSlider.addEventListener('input', updateValues);
        speedSlider.addEventListener('input', updateAnimationSpeed);

        // Touch events for mobile
        canvas.addEventListener('touchstart', handleTouch);
        canvas.addEventListener('touchmove', handleTouch);

        function handleTouch(event) {
            event.preventDefault();
            const touch = event.touches[0];
            const rect = canvas.getBoundingClientRect();
            const x = touch.clientX - rect.left;
            const y = touch.clientY - rect.top;
            
            // Touch bilan parametrlarni o'zgartirish
            if (y < canvas.height / 2) {
                const angle = Math.atan2(y - canvas.height/2, x - canvas.width/2) * 180 / Math.PI;
                angleSlider.value = Math.abs(angle);
                updateValues();
            }
        }

        function updateValues() {
            const force = parseFloat(forceSlider.value);
            const angle = parseFloat(angleSlider.value);
            const distance = parseFloat(distanceSlider.value);
            const angleRad = angle * Math.PI / 180;
            
            // Qiymatlarni ko'rsatish
            forceValue.textContent = force;
            angleValue.textContent = angle;
            distanceValue.textContent = distance.toFixed(1);
            
            // Hisoblashlar
            const cosTheta = Math.cos(angleRad);
            const effectiveF = force * cosTheta;
            const work = effectiveF * distance;
            
            cosValue.textContent = cosTheta.toFixed(3);
            effectiveForce.textContent = effectiveF.toFixed(1);
            currentWork.textContent = work.toFixed(1);
            workValue.textContent = work.toFixed(1);
            
            // Ish turini aniqlash
            updateWorkType(angle, work);
            
            // Animatsiyani yangilash
            if (!isAnimating) {
                draw();
            }
        }

        function updateWorkType(angle, work) {
            if (Math.abs(work) < 0.1) {
                workType.className = 'work-type work-zero';
                workType.textContent = 'Nol ish (Œ∏ ‚âà 90¬∞)';
            } else if (work > 0) {
                workType.className = 'work-type work-positive';
                workType.textContent = 'Ijobiy ish (Œ∏ < 90¬∞)';
            } else {
                workType.className = 'work-type work-negative';
                workType.textContent = 'Salbiy ish (Œ∏ > 90¬∞)';
            }
        }

        function updateAnimationSpeed() {
            animationSpeed = parseFloat(speedSlider.value);
            speedValue.textContent = animationSpeed.toFixed(1);
        }

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            const force = parseFloat(forceSlider.value);
            const angle = parseFloat(angleSlider.value);
            const distance = parseFloat(distanceSlider.value);
            const angleRad = angle * Math.PI / 180;
            
            // Koordinatalar
            const blockSize = 40;
            const startX = 50;
            const startY = canvas.height / 2;
            const maxDistance = canvas.width - 100;
            const blockX = startX + (currentPosition / distance) * (maxDistance - startX);
            
            // Yer chizish
            ctx.fillStyle = '#8B4513';
            ctx.fillRect(0, startY + blockSize/2, canvas.width, 20);
            
            // Blok chizish
            ctx.fillStyle = '#3498db';
            ctx.fillRect(blockX - blockSize/2, startY - blockSize/2, blockSize, blockSize);
            ctx.strokeStyle = '#2980b9';
            ctx.lineWidth = 2;
            ctx.strokeRect(blockX - blockSize/2, startY - blockSize/2, blockSize, blockSize);
            
            // Kuch vektorini chizish
            const forceScale = 2;
            const forceLength = force * forceScale;
            const forceEndX = blockX + forceLength * Math.cos(angleRad);
            const forceEndY = startY - forceLength * Math.sin(angleRad);
            
            // Kuch vektori
            ctx.beginPath();
            ctx.moveTo(blockX, startY);
            ctx.lineTo(forceEndX, forceEndY);
            ctx.strokeStyle = '#e74c3c';
            ctx.lineWidth = 3;
            ctx.stroke();
            
            // Kuch vektori o'qi
            drawArrow(ctx, blockX, startY, forceEndX, forceEndY, '#e74c3c');
            
            // Harakat yo'nalishi
            ctx.beginPath();
            ctx.moveTo(blockX, startY + blockSize/2 + 10);
            ctx.lineTo(blockX + 60, startY + blockSize/2 + 10);
            ctx.strokeStyle = '#2ecc71';
            ctx.lineWidth = 2;
            ctx.stroke();
            drawArrow(ctx, blockX, startY + blockSize/2 + 10, blockX + 60, startY + blockSize/2 + 10, '#2ecc71');
            
            // Burchak chizish
            drawAngle(ctx, blockX, startY, angleRad);
            
            // Matnlar
            ctx.fillStyle = '#2c3e50';
            ctx.font = '14px Arial';
            ctx.fillText(`F = ${force} N`, forceEndX + 5, forceEndY - 5);
            ctx.fillText(`Œ∏ = ${angle}¬∞`, blockX + 20, startY - 20);
            ctx.fillText(`s = ${currentPosition.toFixed(1)} m`, blockX, startY + blockSize/2 + 30);
            
            // Samarali kuch komponenti
            const effectiveF = force * Math.cos(angleRad);
            if (Math.abs(effectiveF) > 0.1) {
                ctx.beginPath();
                ctx.moveTo(blockX, startY);
                ctx.lineTo(blockX + effectiveF * forceScale, startY);
                ctx.strokeStyle = '#f39c12';
                ctx.lineWidth = 2;
                ctx.stroke();
                ctx.fillStyle = '#f39c12';
                ctx.fillText(`F cos Œ∏ = ${effectiveF.toFixed(1)} N`, blockX + effectiveF * forceScale + 5, startY - 5);
            }
        }

        function drawArrow(ctx, startX, startY, endX, endY, color) {
            const headlen = 10;
            const angle = Math.atan2(endY - startY, endX - startX);
            
            ctx.strokeStyle = color;
            ctx.fillStyle = color;
            ctx.lineWidth = 2;
            
            ctx.beginPath();
            ctx.moveTo(endX, endY);
            ctx.lineTo(endX - headlen * Math.cos(angle - Math.PI/6), endY - headlen * Math.sin(angle - Math.PI/6));
            ctx.moveTo(endX, endY);
            ctx.lineTo(endX - headlen * Math.cos(angle + Math.PI/6), endY - headlen * Math.sin(angle + Math.PI/6));
            ctx.stroke();
        }

        function drawAngle(ctx, centerX, centerY, angleRad) {
            const radius = 30;
            
            ctx.beginPath();
            ctx.arc(centerX, centerY, radius, 0, -angleRad, angleRad > 0);
            ctx.strokeStyle = '#9b59b6';
            ctx.lineWidth = 2;
            ctx.stroke();
        }

        function startAnimation() {
            if (!isAnimating) {
                isAnimating = true;
                currentPosition = 0;
                currentTime = 0;
                workHistory = [];
                timeHistory = [];
                animate();
            }
        }

        function pauseAnimation() {
            isAnimating = false;
            if (animationId) {
                cancelAnimationFrame(animationId);
            }
        }

        function resetAnimation() {
            isAnimating = false;
            currentPosition = 0;
            currentTime = 0;
            workHistory = [];
            timeHistory = [];
            if (animationId) {
                cancelAnimationFrame(animationId);
            }
            draw();
            drawChart();
        }

        function animate() {
            if (!isAnimating) return;
            
            const distance = parseFloat(distanceSlider.value);
            const force = parseFloat(forceSlider.value);
            const angle = parseFloat(angleSlider.value);
            const angleRad = angle * Math.PI / 180;
            
            if (currentPosition < distance) {
                currentPosition += 0.05 * animationSpeed;
                currentTime += 0.05;
                
                // Ish hisoblash
                const work = force * Math.cos(angleRad) * currentPosition;
                workHistory.push(work);
                timeHistory.push(currentTime);
                
                draw();
                drawChart();
                
                animationId = requestAnimationFrame(animate);
            } else {
                isAnimating = false;
            }
        }

        function drawChart() {
            chartCtx.clearRect(0, 0, chartCanvas.width, chartCanvas.height);
            
            if (workHistory.length < 2) return;
            
            const maxWork = Math.max(...workHistory.map(Math.abs));
            const chartWidth = chartCanvas.width - 60;
            const chartHeight = chartCanvas.height - 60;
            const chartX = 40;
            const chartY = 20;
            
            // Koordinata o'qlari
            chartCtx.strokeStyle = '#34495e';
            chartCtx.lineWidth = 2;
            chartCtx.beginPath();
            chartCtx.moveTo(chartX, chartY);
            chartCtx.lineTo(chartX, chartY + chartHeight);
            chartCtx.lineTo(chartX + chartWidth, chartY + chartHeight);
            chartCtx.stroke();
            
            // Grafik chizish
            chartCtx.strokeStyle = '#3498db';
            chartCtx.lineWidth = 2;
            chartCtx.beginPath();
            
            for (let i = 0; i < workHistory.length; i++) {
                const x = chartX + (i / (workHistory.length - 1)) * chartWidth;
                const y = chartY + chartHeight - (workHistory[i] / maxWork) * chartHeight * 0.8;
                
                if (i === 0) {
                    chartCtx.moveTo(x, y);
                } else {
                    chartCtx.lineTo(x, y);
                }
            }
            chartCtx.stroke();
            
            // Yorliqlar
            chartCtx.fillStyle = '#2c3e50';
            chartCtx.font = '12px Arial';
            chartCtx.fillText('W (J)', 5, chartY + 15);
            chartCtx.fillText('s (m)', chartX + chartWidth - 20, chartY + chartHeight + 15);
        }

        function setPreset(type) {
            switch(type) {
                case 'positive':
                    forceSlider.value = 80;
                    angleSlider.value = 30;
                    distanceSlider.value = 6;
                    break;
                case 'negative':
                    forceSlider.value = 60;
                    angleSlider.value = 150;
                    distanceSlider.value = 4;
                    break;
                case 'zero':
                    forceSlider.value = 70;
                    angleSlider.value = 90;
                    distanceSlider.value = 5;
                    break;
            }
            updateValues();
        }

        function exportData() {
            const data = {
                force: parseFloat(forceSlider.value),
                angle: parseFloat(angleSlider.value),
                distance: parseFloat(distanceSlider.value),
                work: parseFloat(currentWork.textContent),
                workHistory: workHistory,
                timeHistory: timeHistory
            };
            
            const dataStr = JSON.stringify(data, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'mexanik_ish_data.json';
            link.click();
            URL.revokeObjectURL(url);
        }

        // Klaviatura yorliqlari
        document.addEventListener('keydown', function(e) {
            switch(e.key) {
                case ' ':
                    e.preventDefault();
                    if (isAnimating) {
                        pauseAnimation();
                    } else {
                        startAnimation();
                    }
                    break;
                case 'r':
                    resetAnimation();
                    break;
                case 'ArrowUp':
                    forceSlider.value = Math.min(100, parseInt(forceSlider.value) + 1);
                    updateValues();
                    break;
                case 'ArrowDown':
                    forceSlider.value = Math.max(0, parseInt(forceSlider.value) - 1);
                    updateValues();
                    break;
                case 'ArrowLeft':
                    angleSlider.value = Math.max(0, parseInt(angleSlider.value) - 1);
                    updateValues();
                    break;
                case 'ArrowRight':
                    angleSlider.value = Math.min(180, parseInt(angleSlider.value) + 1);
                    updateValues();
                    break;
            }
        });

        // Sahifa yuklanganida
        window.addEventListener('load', function() {
            updateValues();
            draw();
            drawChart();
        });

        // Responsive canvas
        function resizeCanvas() {
            const container = canvas.parentElement;
            const containerWidth = container.offsetWidth;
            if (containerWidth < 600) {
                canvas.width = containerWidth - 40;
                canvas.height = (containerWidth - 40) * 2/3;
            }
            draw();
        }

        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();
    </script>
</body>
</html>
